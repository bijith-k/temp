import{e as O,r as n,b as $,u as j,a as R,d as v,j as s,f as T,c as e,o as U,p as _,B as F,s as M,N as q,S as P}from"./index-75e0cb1c.js";import{u as H}from"./user-4891dc53.js";import{B as z,a as G,M as Q,b as V}from"./index.esm-b2e70fb2.js";import{H as Z}from"./index.esm-90dfe48c.js";import{I as p,a as h}from"./chunk-J356FWKS-814e3883.js";import{I as x}from"./chunk-GYFRIY2Z-587d8fc4.js";import{S as L}from"./chunk-GJO77I2I-e28f2d83.js";import{B as Y}from"./index.esm-efe2c39d.js";import{F as J}from"./Footer-62cbe905.js";import"./chunk-IJBC3YLI-ecd8dcc2.js";import"./logoWhite-701db893.js";const K=()=>{const{student:l}=O(t=>t.student),[r,g]=n.useState([]),[S,N]=n.useState([]),[i,E]=n.useState(l.board._id),[f,w]=n.useState(l.branch._id),c=$(),y=j(),I=R(),[a,d]=n.useState({name:l.name,email:l.email,phone:l.phone,school:l.school,profilePic:""}),[b,u]=n.useState(!1),[o,C]=n.useState(null);n.useEffect(()=>{v("Stoken").get("boards").then(t=>{t.data.status==!1?(localStorage.removeItem("Stoken"),y("/signin")):g(t.data.boards)}).catch(t=>{console.error(t),c({title:t.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),n.useEffect(()=>{i?v("Stoken").get(`http://localhost:4000/branches?board=${i}`).then(t=>{t.data.status==!1?(localStorage.removeItem("Stoken"),y("/signin")):N(t.data.branches)}).catch(t=>{console.log(t),c({title:t.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}):N([])},[i]);const k=async t=>{let D=/^[a-zA-ZÀ-ÖØ-öø-ÿ-']+(\s+[a-zA-ZÀ-ÖØ-öø-ÿ-']+)*$/,B=/^\S+@\S+\.\S+$/,A=/^[789]\d{9}$/;if(!a.name||!a.email||!a.phone||!a.school||!i||!f||!D.test(a.name)||!B.test(a.email)||!A.test(a.phone))return c({title:"Enter correct details",description:"All fields are required",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});if(a.profilePic&&a.profilePic.type!=="image/png"&&a.profilePic.type!=="image/jpeg")return c({title:"Select only image for profile picture",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});u(!0),await v("Stoken").post(`edit-profile-details?id=${l._id}`,{...a,board:i,branch:f},{headers:{"Content-Type":"multipart/form-data"}}).then(m=>{m.data.updated?(c({title:m.data.message,status:"success",duration:5e3,isClosable:!0,position:"bottom-right"}),I(M({student:m.data.student})),u(!1)):(c({title:m.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),u(!1))}).catch(m=>{console.log(m),c({title:m.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),u(!1)})};return s(T,{spacing:4,className:"mt-5 w-2/3 mx-auto",children:[s(p,{children:[e(h,{pointerEvents:"none",children:e(z,{color:"gray.300"})}),e(x,{type:"text",value:a.name,onChange:t=>d({...a,name:t.target.value}),placeholder:"Name"})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(U,{color:"gray.300"})}),e(x,{type:"email",value:a.email,onChange:t=>d({...a,email:t.target.value}),placeholder:"Email"})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(_,{color:"gray.300"})}),e(x,{type:"tel",value:a.phone,onChange:t=>d({...a,phone:t.target.value}),placeholder:"Phone number"})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(Z,{color:"gray.300"})}),e(L,{placeholder:"Select Board",value:i,onChange:t=>{E(t.target.value),C(null)},className:"pl-10 uppercase",children:r.map(t=>e("option",{value:t._id,className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:t.name},t._id))})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(G,{color:"gray.300"})}),e(L,{placeholder:"Select Branch",value:f,onChange:t=>{w(t.target.value),C(null)},className:"pl-10 uppercase",children:S.map(t=>e("option",{value:t._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:t.name},t._id))})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(Q,{color:"gray.300"})}),e(x,{type:"text",value:a.school,onChange:t=>d({...a,school:t.target.value}),placeholder:"School or College Name"})]}),s(p,{children:[e(h,{pointerEvents:"none",children:e(V,{color:"gray.300"})}),e(x,{type:"file",name:"profilePic",accept:"image/*",placeholder:"Dp",onChange:t=>{d({...a,profilePic:t.target.files[0]})},className:"pt-1"})]}),e(F,{isloading:b,loadingText:"Updating",colorScheme:"teal",variant:"solid",onClick:k,children:"UPDATE PROFILE"})]})},ce=()=>{const l=$(),{student:r}=O(o=>o.student),[g,S]=n.useState(!1),[N,i]=n.useState(!1),[E,f]=n.useState(""),[w,c]=n.useState(""),[y,I]=n.useState(""),[a,d]=n.useState({name:"",startDate:"",endDate:"",price:"",duration:""}),b=j();function u(o){const[C,k]=o.split("T"),[t,D,B]=C.split("-");return`${B}-${D}-${t.slice(-2)}`}return n.useEffect(()=>{v("Stoken").get("get-upload-counts").then(o=>{o.data.status==!1?(l({title:o.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Stoken"),b("/signin")):(f(o.data.noteCounts),c(o.data.videoCounts),I(o.data.questionCounts),S(!0))}).catch(o=>{S(!0),console.log(o),l({title:o.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),n.useEffect(()=>{v("Stoken").get("get-subscribed-plan").then(o=>{i(!0),o.data.subscribed?d({name:o.data.plan.plan,startDate:o.data.plan.used_by[0].startedAt,endDate:o.data.plan.used_by[0].expiredAt,price:o.data.plan.price,duration:o.data.plan.duration}):o.data.status==!1&&(l({title:o.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Stoken"),b("/signin"))}).catch(o=>{i(!0),console.log(o),l({title:o.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),s("div",{className:"min-h-screen max-w-screen-2xl mx-auto w-full pt-16 bg-[#d4d8f0] overflow-x-hidden",children:[e(q,{}),e("div",{className:" h-72",children:s("h1",{className:"text-center font-extrabold text-[#232946] shadow-inner font-sans text-4xl md:pt-32 pt-20 uppercase",children:["HAPPY LEARNING ",r.name]})}),e("div",{children:s("div",{className:"p-8 bg-white shadow",children:[" ",s("div",{className:"grid grid-cols-1 md:grid-cols-3",children:[" ",s("div",{className:"grid grid-cols-3 text-center order-last md:order-first mt-20 md:mt-0",children:[s("div",{children:[e(P,{width:"10",mx:"auto",isLoaded:g,children:e("p",{className:"font-bold text-gray-700 text-xl",children:E})}),e("p",{className:"text-gray-400",children:"NOTES UPLOADS"})," "]})," ",s("div",{children:[" ",e(P,{width:"10",mx:"auto",isLoaded:g,children:e("p",{className:"font-bold text-gray-700 text-xl",children:w})})," ",e("p",{className:"text-gray-400",children:"VIDEOS UPLOADS"})," "]})," ",s("div",{children:[" ",e(P,{width:"10",mx:"auto",isLoaded:g,children:e("p",{className:"font-bold text-gray-700 text-xl",children:y})})," ",e("p",{className:"text-gray-400",children:"QUESTION PAPER UPLOADS"})," "]})," "]})," ",s("div",{className:"relative",children:[" ",e("div",{className:"w-48 h-48 bg-indigo-100 mx-auto rounded-full shadow-2xl absolute inset-x-0 top-0 -mt-24 flex items-center justify-center text-indigo-500",children:e("img",{src:r.profilePicture?`http://localhost:4000/${r.profilePicture}`:H,alt:"",className:"h-48 w-48 rounded-full"})})," "]})," ",e("div",{className:"space-x-8 flex justify-center mt-32 md:mt-0 md:justify-center",children:e(P,{isLoaded:N,children:a!=null&&a.name?s("div",{className:"text-white p-5 uppercase rounded bg-[#d4939d] shadow hover:shadow-lg font-medium transition transform hover:-translate-y-0.5",children:[e("p",{className:"text-center",children:"subscribed to "}),s("p",{className:"text-center",children:[a.name," plan"]}),s("p",{className:"text-center",children:[" ","Subscribed on ",u(a.startDate)]}),s("p",{className:"text-center",children:["will expire on ",u(a.endDate)]}),s("p",{className:"text-center",children:["Price : ",e(Y,{className:"inline"}),a.price]})]}):s("div",{className:"text-white p-5 uppercase rounded bg-red-400 flex flex-col justify-center hover:bg-red-500 shadow hover:shadow-lg font-medium transition transform hover:-translate-y-0.5",children:[e("p",{className:"text-center",children:"you are not subscribed to any plan"}),e(F,{className:"mx-auto bg-[#eebbc3] text-[#232946] mt-3 uppercase",onClick:()=>b("/plans"),children:"Buy One"})]})})})]})," ",s("div",{className:"mt-10 text-center border-b pb-12",children:[" ",e("h1",{className:"text-4xl font-medium text-gray-700 uppercase",children:r.name})," ",s("p",{className:"mt-4 text-gray-500 uppercase",children:[r.board.name,",",r.branch.name]})," ",e("p",{className:"mt-2 text-gray-500 uppercase",children:r.school})," "]})," ",s("div",{className:"mt-5 flex flex-col justify-center",children:[e("p",{className:"text-gray-600 text-center font-bold lg:px-16",children:"UPDATE PROFILE INFORMATIONS"}),e(K,{})]})]})}),e("div",{children:e(J,{})})]})};export{ce as default};
