import{u as j,r as a,b as B,d as c,j as i,c as t,N as E,B as _}from"./index-75e0cb1c.js";import{H as T}from"./Header-318919e1.js";import{H as D}from"./HeadTitle-2e5ed730.js";import{F}from"./Footer-62cbe905.js";import"./logoWhite-701db893.js";const O=()=>{const p=j(),[N,v]=a.useState([]),[w,h]=a.useState([]),[l,y]=a.useState(""),[r,f]=a.useState(""),[u,m]=a.useState(""),[C,g]=a.useState([]),[k,b]=a.useState(null),o=B(),[s,S]=a.useState({note:null,noteName:""});a.useEffect(()=>{c("Stoken").get("boards").then(e=>{e.data.status==!1?(o({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Stoken"),p("/signin")):v(e.data.boards)}).catch(e=>{console.error(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),a.useEffect(()=>{l?(f(""),m(""),c("Stoken").get(`branches?board=${l}`).then(e=>{h(e.data.branches)}).catch(e=>{console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})):h([])},[l]),a.useEffect(()=>{r?(m(""),c("Stoken").get(`subjects?branch=${r}`).then(e=>{g(e.data.subjects)}).catch(e=>{console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})):g([])},[r,l]);const d=e=>{o({title:e,status:"warning",duration:5e3,isClosable:!0,position:"top"})};return i("div",{className:"bg-[#d4d8f0] min-h-screen max-w-screen-2xl mx-auto pt-16 w-full overflow-x-hidden",children:[t(E,{}),t(T,{}),t(D,{title:"upload notes"}),i("form",{action:"",onSubmit:async e=>{if(e.preventDefault(),!l){d("Select a board");return}if(!r){d("Select a branch");return}if(!u){d("Select a subject");return}const x=/^[a-zA-Z0-9_-\s]+$/;if(!s.noteName||!x.test(s.noteName)){d("Enter the name of the note");return}if(!s.note||s.note.type!=="application/pdf"){d("Select a note to upload or You have selected a file otherthan pdf");return}b(!0),await c("Stoken").post("upload-notes",{...s,board:l,branch:r,subject:u,exclusive:!1},{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{b(!1),n.data.uploaded?(o({title:n.data.message,status:"success",duration:5e3,isClosable:!0,position:"top"}),p("/my-uploads")):o({title:n.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}).catch(n=>{b(!1),console.log(n),o({title:n.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},className:"m-3 w-3/4 mx-auto",children:[i("select",{name:"board",value:l,onChange:e=>{y(e.target.value)},className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4",disabled:!0,children:"Select Board/University"}),N.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:e.name},e._id))]}),i("select",{name:"branch",className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",value:r,onChange:e=>{f(e.target.value)},children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4 ",disabled:!0,children:"Select Class/Branch"}),w.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:e.name},e._id))]}),i("select",{name:" subject",value:u,onChange:e=>{m(e.target.value)},className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4",disabled:!0,children:"Select Subject"}),C.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:e.name},e._id))]}),t("label",{htmlFor:"noteName",className:" font-medium",children:"Enter the name of note"}),t("input",{type:"text",name:"noteName",className:"w-full p-3 mb-2",placeholder:"Enter name of note",value:s.noteName,onChange:e=>{S({...s,noteName:e.target.value})}})," ",t("br",{}),t("label",{htmlFor:"notes",className:" font-medium",children:"Select the file"}),t("input",{type:"file",name:"note",className:"w-full bg-white p-2",onChange:e=>{S({...s,note:e.target.files[0]})}}),i("p",{children:[" ","*These notes will be published only ",t("br",{})," after admin verification"]}),t(_,{isLoading:k,type:"submit",className:"bg-[#232946] p-3 font-semibold text-white rounded-lg mt-2",children:"UPLOAD NOTE"})]}),t("div",{className:"mt-5",children:t(F,{})})]})};export{O as default};
