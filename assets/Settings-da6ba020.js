import{e as H,u as L,r as a,b as O,j as n,c as t,N as B,B as c,o as R,d as C}from"./index-75e0cb1c.js";import{H as T}from"./Header-318919e1.js";import{H as j}from"./HeadTitle-2e5ed730.js";import{F}from"./Footer-62cbe905.js";import{I as u,b as f,a as A}from"./chunk-J356FWKS-814e3883.js";import{I as m}from"./chunk-GYFRIY2Z-587d8fc4.js";import"./logoWhite-701db893.js";import"./chunk-IJBC3YLI-ecd8dcc2.js";const K=()=>{H(e=>e.student);const v=L(),[p,P]=a.useState(!1),[h,x]=a.useState(!1),E=()=>P(!p),k=()=>x(!h),s=O(),[N,l]=a.useState(!1),[y,d]=a.useState(!1),[o,g]=a.useState({currentPassword:"",newPassword:""}),[i,b]=a.useState(""),[w,S]=a.useState(""),I=async()=>{if(!o.currentPassword||!o.newPassword)return s({title:"Enter passwords",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});if(o.newPassword.length<6)return s({title:"Password should be atlest 6 character length",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});if(!i)return s({title:"Enter email to get otp for verification",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});if(!w)return s({title:"Enter otp got in email to continue",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});l(!0),await C("Stoken").post("change-password",{...o,otp:w}).then(e=>{e.data.updated?(s({title:e.data.message,status:"success",duration:5e3,isClosable:!0,position:"bottom-right"}),l(!1),g({currentPassword:"",newPassword:""}),b(""),S(""),localStorage.removeItem("Stoken"),v("/signin")):(s({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),l(!1))}).catch(e=>{console.log(e),s({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),l(!1)})},z=async()=>{if(!i||!/^\S+@\S+\.\S+$/.test(i))return s({title:"Enter email",description:"Enter valid email only.Otp will be sent to that email",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});d(!0),await C("Stoken").post("get-password-change-otp",{email:i}).then(r=>{r.data.otpSend?(s({title:r.data.message,status:"success",duration:5e3,isClosable:!0,position:"bottom-right"}),d(!1)):(s({title:r.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),d(!1))}).catch(r=>{console.log(r),s({title:r.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),d(!1)})};return n("div",{className:"min-h-screen max-w-screen-2xl mx-auto w-full pt-16  overflow-x-hidden",children:[t(B,{}),t(T,{}),t(j,{title:"settings"}),n("div",{className:"mt-5 w-2/3 h-screen mx-auto",children:[n(u,{size:"md",children:[t(m,{pr:"4.5rem",type:p?"text":"password",placeholder:"Enter current password",value:o.currentPassword,onChange:e=>{g({...o,currentPassword:e.target.value})}}),t(f,{width:"4.5rem",children:t(c,{h:"1.75rem",size:"sm",onClick:E,children:p?"Hide":"Show"})})]}),n(u,{size:"md",className:"my-5",children:[t(m,{pr:"4.5rem",type:h?"text":"password",placeholder:"Enter new password",value:o.newPassword,onChange:e=>{g({...o,newPassword:e.target.value})}}),t(f,{width:"4.5rem",children:t(c,{h:"1.75rem",size:"sm",onClick:k,children:h?"Hide":"Show"})})]}),n(u,{children:[t(A,{pointerEvents:"none",children:t(R,{color:"gray.300"})}),t(m,{type:"email",value:i,onChange:e=>b(e.target.value),placeholder:"Enter email to get otp"}),t(f,{width:"7.5rem",children:t(c,{isLoading:y,h:"1.75rem",size:"sm",className:"mr-1",colorScheme:"teal",variant:"solid",onClick:z,children:"Click to get otp"})})]}),t(u,{size:"md",className:"mt-5",children:t(m,{pr:"4.5rem",type:"text",placeholder:"Enter the otp",value:w,onChange:e=>{S(e.target.value)}})}),t(c,{isLoading:N,loadingText:"Updating",colorScheme:"teal",variant:"solid",className:"mt-5",onClick:I,children:"UPDATE PASSWORD"})]}),t("div",{className:"mt-5",children:t(F,{})})]})};export{K as default};
