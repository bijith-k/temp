import{b as j,r as s,u as C,d as i,j as n,c as a}from"./index-75e0cb1c.js";import{S as I}from"./Sidebar-33147c50.js";import"./index.esm-efe2c39d.js";import"./index.esm-ed29fecc.js";import"./index.esm-b2e70fb2.js";import"./index.esm-90dfe48c.js";import"./index.esm-21486a75.js";const _=()=>{const t=j(),[g,f]=s.useState([]),[S,p]=s.useState([]),[r,c]=s.useState(""),[u,m]=s.useState(""),[d,b]=s.useState(""),l=C();s.useEffect(()=>{i("Adtoken").get("admin/boards").then(e=>{e.data.status==!1?(t({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Adtoken"),l("/admin")):f(e.data.boards)}).catch(e=>{console.error(e),t({title:error.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),s.useEffect(()=>{r?i("Adtoken").get(`http://localhost:4000/admin/branches?board=${r}`,{headers:{authorization:`Bearer ${localStorage.getItem("Adtoken")}`}}).then(e=>{p(e.data.branches)}).catch(e=>{console.log(e),t({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}):p([])},[r]);const h=localStorage.getItem("subjectId"),v=localStorage.getItem("subBranchId");return s.useEffect(()=>{i("Adtoken").get(`admin/subjects?id=${h}`).then(e=>{e.data.status==!1?(t({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Adtoken"),l("/admin")):(m(e.data.subjects.branch._id),b(e.data.subjects.name))}).catch(e=>{console.log(e),t({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}),i("Adtoken").get(`admin/branches?id=${v}`).then(e=>{e.data.status==!1?(t({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Adtoken"),l("/admin")):c(e.data.branches.board._id)}).catch(e=>{console.log(e),t({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),n("div",{className:"bg-sky-900 min-h-screen max-w-screen-2xl mx-auto flex overflow-x-hidden",children:[a("div",{className:"bg-dark-purple",children:a(I,{})}),n("div",{className:"w-full mt-10",children:[a("h1",{className:"text-center text-black  font-extrabold bg-white p-3 ",children:"EDIT SUBJECT"}),n("form",{action:"",onSubmit:e=>{e.preventDefault();const x=/^[a-zA-Z0-9]+([ \-'][a-zA-Z0-9]+)*$/;if(!r)return t({title:"Please select a board",status:"warning",duration:5e3,isClosable:!0,position:"top"});if(!u)return t({title:"Please select a branch",status:"warning",duration:5e3,isClosable:!0,position:"top"});if(!d||!x.test(d))return t({title:"Please enter the subject name",description:"Don't start name with spaces",status:"warning",duration:5e3,isClosable:!0,position:"top"});i("Adtoken").post(`admin/edit-subject?id=${h}`,{branch:u,subject:d}).then(o=>{o.data.status==!1?(t({title:o.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Adtoken"),l("/admin")):(localStorage.removeItem("subjectId"),localStorage.removeItem("subBranchId"),t({title:o.data.message,status:"success",duration:5e3,isClosable:!0,position:"top"}),c(""),m(""),b(""),l("/admin/subject"))}).catch(o=>{t({title:o.message,status:"success",duration:5e3,isClosable:!0,position:"top"}),console.error(o,"err")})},className:"flex flex-col mx-auto w-3/4 mt-8",children:[n("select",{id:"board",value:r,onChange:e=>c(e.target.value),className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[a("option",{value:"",disabled:!0,children:"Select Board"}),g.map(e=>a("option",{value:e._id,children:e.name},e._id))]}),n("select",{id:"branch",value:u,onChange:e=>m(e.target.value),className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[a("option",{value:"",disabled:!0,children:"Select Branch"}),S.map(e=>a("option",{value:e._id,children:e.name},e._id))]}),a("input",{type:"text",placeholder:"Enter subject name",value:d,onChange:e=>b(e.target.value),id:"subjectName",className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase"}),a("button",{type:"submit",className:"bg-gray-300 text-sky-900 p-3 font-semibold rounded-lg mt-2",children:"EDIT SUBJECT"})]})]})]})};export{_ as default};
