import{u as T,b as B,r as a,e as E,d as m,j as n,c as t,B as _}from"./index-75e0cb1c.js";import{N as I,F as D}from"./Footer-9eebb72f.js";import"./index.esm-ed29fecc.js";import"./index.esm-21486a75.js";import"./index.esm-b2e70fb2.js";import"./logoWhite-701db893.js";const z=()=>{const r=T(),o=B(),[S,y]=a.useState([]),[k,f]=a.useState([]),[l,w]=a.useState(""),[i,g]=a.useState(""),[b,p]=a.useState(""),[x,N]=a.useState([]),[C,h]=a.useState(null),[s,v]=a.useState({note:null,noteName:""}),{tutor:u}=E(e=>e.tutor);a.useEffect(()=>{u.approved==!1&&u.rejected==!1?r("/tutor/approval-pending"):u.rejected?r("/tutor/approval-rejected"):u.blocked&&(localStorage.removeItem("Ttoken"),r("/tutor"),o({title:"Blocked",description:"Your account is blocked by the admin",status:"error",duration:5e3,isClosable:!0,position:"top"}))},[]),a.useEffect(()=>{m("Ttoken").get("tutor/boards").then(e=>{e.data.status==!1?(o({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Ttoken"),r("/tutor")):y(e.data.boards)}).catch(e=>{console.error(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),a.useEffect(()=>{l?(g(""),p(""),m("Ttoken").get(`tutor/branches?board=${l}`).then(e=>{e.data.status==!1?(localStorage.removeItem("Ttoken"),r("/tutor")):f(e.data.branches)}).catch(e=>{console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})):f([])},[l]),a.useEffect(()=>{i?(p(""),m("Ttoken").get(`tutor/subjects?branch=${i}`).then(e=>{e.data.status==!1?(localStorage.removeItem("Ttoken"),r("/tutor")):N(e.data.subjects)}).catch(e=>{console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})):N([])},[i,l]);const c=e=>{o({title:e,status:"warning",duration:5e3,isClosable:!0,position:"top"})};return n("div",{className:"bg-gray-400 min-h-screen max-w-screen-2xl mx-auto w-full",children:[t(I,{}),n("div",{className:"",children:[t("div",{className:"bg-gray-600",children:t("h1",{className:"font-bold text-white text-center text-lg uppercase h-12 p-2",children:"upload notes"})}),n("form",{action:"",onSubmit:async e=>{if(e.preventDefault(),!l){c("Select a board");return}if(!i){c("Select a branch");return}if(!b){c("Select a subject");return}const j=/^[a-zA-Z0-9_-\s]+$/;if(!s.noteName||!j.test(s.noteName)){c("Enter the name of the note");return}if(!s.note||s.note.type!=="application/pdf"){c("Select a note to upload or You have selected a file otherthan pdf");return}h(!0),await m("Ttoken").post("tutor/upload-notes",{...s,board:l,branch:i,subject:b,exclusive:!0},{headers:{"Content-Type":"multipart/form-data"}}).then(d=>{h(!1),d.data.uploaded?r("/tutor/uploads"):o({title:d.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}).catch(d=>{h(!1),console.log(d),o({title:err.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},className:"m-3 w-3/4 mx-auto",children:[n("select",{name:"board",value:l,onChange:e=>{w(e.target.value)},className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4",disabled:!0,children:"Select Board/University"}),S.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:e.name},e._id))]}),n("select",{name:"branch",className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",value:i,onChange:e=>{g(e.target.value)},children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4 ",disabled:!0,children:"Select Class/Branch"}),k.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:e.name},e._id))]}),n("select",{name:" subject",value:b,onChange:e=>{p(e.target.value)},className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:[t("option",{value:"",className:"block border border-grey-light w-full p-3 rounded mb-4",disabled:!0,children:"Select Subject"}),x.map(e=>t("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:e.name},e._id))]}),t("label",{htmlFor:"noteName",className:" font-medium",children:"Enter the name of note"}),t("input",{type:"text",name:"noteName",className:"w-full p-3 mb-2",placeholder:"Enter name of note",value:s.noteName,onChange:e=>{v({...s,noteName:e.target.value})}})," ",t("br",{}),t("label",{htmlFor:"notes",className:" font-medium",children:"Select the file"}),t("input",{type:"file",name:"note",className:"w-full bg-white p-2",onChange:e=>{v({...s,note:e.target.files[0]})}}),n("p",{children:[" ","*These notes will be published only ",t("br",{})," after admin verification"]}),t(_,{isLoading:C,type:"submit",className:"bg-gray-600 p-3 font-semibold text-white rounded-lg mt-2",children:"UPLOAD NOTE"})]})]}),t("div",{className:"mt-5",children:t(D,{})})]})};export{z as default};
