import{e as P,r as i,u as _,b as z,d as r,j as a,c as t,N as E,g as c,S as p,k as F}from"./index-75e0cb1c.js";import{F as I}from"./index.esm-ed29fecc.js";import{H as T}from"./Header-318919e1.js";import{H as j}from"./HeadTitle-2e5ed730.js";import{F as R}from"./Footer-62cbe905.js";import{S as s}from"./chunk-QTKSMHLN-f35984ae.js";import"./logoWhite-701db893.js";const J=()=>{const{student:f}=P(e=>e.student),[b,x]=i.useState([]),[A,d]=i.useState([]),[w,g]=i.useState(!1),[k,h]=i.useState(!0),m=_(),[S,y]=i.useState(!1),o=z();i.useEffect(()=>{r("Stoken").get("get-plans").then(e=>{e.data.status==!1?(o({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Stoken"),m("/signin")):(x(e.data),h(!1))}).catch(e=>{h(!1),console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),i.useEffect(()=>{r("Stoken").get(`get-subscribed-plan?id=${f._id}`).then(e=>{e.data.subscribed?y(!0):e.data.status==!1&&(localStorage.removeItem("Stoken"),m("/signin"))}).catch(e=>{console.log(e),o({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]);const N=(e,n)=>{const H={key:"rzp_test_Rkm69ClVHaPCAu",amount:e.amount,name:n.plan,description:"Test transaction",currency:e.currency,order_id:e.id,handler:async L=>{try{const{razorpay_payment_id:l,razorpay_order_id:C,razorpay_signature:O}=L,{data:u}=await r("Stoken").post("verify-payment",{razorpay_payment_id:l,razorpay_order_id:C,razorpay_signature:O,plan:n});u.verified?(g(!1),d(null),o({title:u.message,status:"success",duration:5e3,isClosable:!0,position:"top"}),m("/")):o({title:u.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}catch(l){console.log(l),g(!1),d(null),o({title:l.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}},theme:{color:"#3399cc"}};new Razorpay(H).open()},v=async e=>{try{if(S)return o({title:"You already have a subscription plan",description:"Please check your profile page for details",status:"warning",duration:5e3,isClosable:!0,position:"top"});const{data:n}=await r("Stoken").post("buy-plan",{id:e._id});N(n.data,e)}catch(n){o({title:n.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}};return a("div",{className:"min-h-screen max-w-screen-2xl mx-auto w-full pt-16 bg-[#d4d8f0] overflow-x-hidden",children:[t(E,{}),t(T,{}),t(j,{title:"available plans"}),k?a(c,{className:"flex flex-col md:flex-row gap-2",children:[a(c,{padding:"6",boxShadow:"lg",bg:"white",className:"mt-5 mx-auto h-80 md:w-2/6 w-80 rounded-3xl",children:[t(s,{mt:"8",noOfLines:1,spacing:"4",skeletonHeight:"3"}),t(s,{mt:"8",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"5",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"4",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(p,{height:"7",mt:"6",width:"36",className:"mx-auto"})]}),a(c,{padding:"6",boxShadow:"lg",bg:"white",className:"mt-5 mx-auto h-80 md:w-2/6 w-80 rounded-3xl",children:[t(s,{mt:"8",noOfLines:1,spacing:"4",skeletonHeight:"3"}),t(s,{mt:"8",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"5",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"4",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(p,{height:"7",mt:"6",width:"36",className:"mx-auto"})]}),a(c,{padding:"6",boxShadow:"lg",bg:"white",className:"mt-5 mx-auto h-80 md:w-2/6 w-80 rounded-3xl",children:[t(s,{mt:"8",noOfLines:1,spacing:"4",skeletonHeight:"3"}),t(s,{mt:"8",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"5",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(s,{mt:"4",noOfLines:2,spacing:"4",skeletonHeight:"2"}),t(p,{height:"7",mt:"6",width:"36",className:"mx-auto"})]})]}):t("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5 p-3 h-full",children:b.map((e,n)=>a("div",{className:"bg-[#fffffe] border-b-4 border-r-4 border-[#d4939d] hover:opacity-90 text-[#232946] hover:scale-105 transition duration-300  w-full rounded-xl mt-5 p-10 h-fit text-center",children:[a("p",{className:"font-black text-2xl uppercase border-b w-fit mx-auto",children:[e.plan," plan"]}),a("p",{className:"font-sans font-bold text-lg mt-8",children:["Chat with tutors and clear ",t("br",{})," your doubts"]}),a("p",{className:"font-sans font-bold text-lg mt-4",children:["Exclusive notes ",t("br",{})," uploaded by tutors"]}),a("p",{className:"font-sans font-medium text-lg mt-3",children:["Plan validity : ",e.duration," Month"]}),a("p",{className:"font-sans font-medium text-lg mt-3",children:["Price : ",t(I,{className:"inline"})," ",e.price," "]}),w?t(F,{className:"mt-5"}):t("span",{onClick:()=>{d(e),v(e)},children:t("p",{className:"bg-[#232946] p-2 text-[#b8c1ec] rounded-3xl uppercase font-bold mt-5 w-2/3 hover:bg-slate-500 hover:text-white mx-auto cursor-pointer",children:"buy now"})})]},n))}),t("div",{className:"mt-5",children:t(R,{})})]})};export{J as default};
