import{e as w,r as c,b as A,u as D,a as _,d as b,j as r,c as o,f as L,o as $,p as M,B as R,q as U}from"./index-75e0cb1c.js";import{B as z,a as O,g as q,h as y,i as H,j as Z,b as G}from"./index.esm-b2e70fb2.js";import{H as W}from"./index.esm-90dfe48c.js";import{N as Y,F as J}from"./Footer-9eebb72f.js";import{I as s,a as l}from"./chunk-J356FWKS-814e3883.js";import{I as p}from"./chunk-GYFRIY2Z-587d8fc4.js";import{S}from"./chunk-GJO77I2I-e28f2d83.js";import"./index.esm-ed29fecc.js";import"./index.esm-21486a75.js";import"./logoWhite-701db893.js";import"./chunk-IJBC3YLI-ecd8dcc2.js";const ie=()=>{const{tutor:a}=w(e=>e.tutor),E=localStorage.getItem("Ttoken"),[T,C]=c.useState([]),[x,v]=c.useState([]),[d,B]=c.useState(a.board._id),[h,j]=c.useState(a.branch._id),i=A(),m=D(),k=_();c.useEffect(()=>{a.approved==!1&&a.rejected==!1?m("/tutor/approval-pending"):a.rejected?m("/tutor/approval-rejected"):a.blocked&&(localStorage.removeItem("Ttoken"),m("/tutor"),i({title:"Blocked",description:"Your account is blocked by the admin",status:"error",duration:5e3,isClosable:!0,position:"top"}))},[]);const[t,n]=c.useState({name:a.name,email:a.email,phone:a.phone,subjects:a.subjects,timeFrom:a.timeFrom,timeTo:a.timeTo,place:a.place,profession:a.profession,profilePic:a.profilePic}),[F,g]=c.useState(!1);c.useEffect(()=>{b("Ttoken").get("tutor/boards",{headers:{authorization:`Bearer ${E}`}}).then(e=>{e.data.status==!1?(i({title:e.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),localStorage.removeItem("Ttoken"),m("/tutor")):C(e.data.boards)}).catch(e=>{console.error(e),i({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})})},[]),c.useEffect(()=>{d?b("Ttoken").get(`tutor/branches?board=${d}`).then(e=>{e.data.status==!1?(localStorage.removeItem("Ttoken"),m("/tutor")):v(e.data.branches)}).catch(e=>{console.log(e),i({title:e.message,status:"error",duration:5e3,isClosable:!0,position:"top"})}):v([])},[d]);const I=async e=>{let f=/^[a-zA-ZÀ-ÖØ-öø-ÿ-']+(\s+[a-zA-ZÀ-ÖØ-öø-ÿ-']+)*$/,N=/^\S+@\S+\.\S+$/,P=/^[789]\d{9}$/;if(console.log(t.name,t.email,t.phone,t.subjects,t.timeFrom,t.timeTo,t.place,t.profession,d,h),!t.name||!t.email||!t.phone||!t.subjects||!t.timeFrom||!t.timeTo||!t.place||!t.profession||!d||!h||!f.test(t.name)||!f.test(t.place)||!f.test(t.profession)||!N.test(t.email)||!P.test(t.phone))return i({title:"Enter correct details",description:"All fields are required",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});if(t.profilePic&&t.profilePic.type!=="image/png"&&t.profilePic.type!=="image/jpeg")return i({title:"Select only image for profile picture",status:"error",duration:5e3,isClosable:!0,position:"bottom-right"});g(!0),await b("Ttoken").post(`tutor/edit-profile-details?id=${a._id}`,{...t,board:d,branch:h},{headers:{"Content-Type":"multipart/form-data"}}).then(u=>{u.data.updated?(i({title:u.data.message,status:"success",duration:5e3,isClosable:!0,position:"bottom-right"}),k(U({tutor:u.data.tutor})),g(!1),m("/tutor/dashboard")):(i({title:u.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),g(!1))}).catch(u=>{console.log(u),i({title:u.message,status:"error",duration:5e3,isClosable:!0,position:"bottom-right"}),g(!1)})};return r("div",{className:"bg-gray-50 min-h-screen max-w-screen-2xl mx-auto",children:[o(Y,{}),o("div",{className:"bg-gray-600 uppercase h-14 text-center text-white font-bold text-xl pt-3",children:"UPDATE DETAILS"}),r(L,{spacing:4,className:"mt-5 w-2/3 mx-auto",children:[r(s,{children:[o(l,{pointerEvents:"none",children:o(z,{color:"gray.300"})}),o(p,{type:"text",value:t.name,onChange:e=>n({...t,name:e.target.value}),placeholder:"Name"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o($,{color:"gray.300"})}),o(p,{type:"email",value:t.email,onChange:e=>n({...t,email:e.target.value}),placeholder:"Email"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(M,{color:"gray.300"})}),o(p,{type:"tel",value:t.phone,onChange:e=>n({...t,phone:e.target.value}),placeholder:"Phone number"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(W,{color:"gray.300"})}),o(S,{placeholder:"Select Board",value:d,onChange:e=>{B(e.target.value)},className:"pl-10 uppercase",children:T.map(e=>o("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4 uppercase",children:e.name},e._id))})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(O,{color:"gray.300"})}),o(S,{placeholder:"Select Branch",value:h,onChange:e=>{j(e.target.value)},className:"pl-10 uppercase",children:x.map(e=>o("option",{value:e._id,className:"block border border-grey-light w-full p-3 rounded mb-4",children:e.name},e._id))})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(q,{color:"gray.300"})}),o(p,{type:"text",value:t.subjects,onChange:e=>n({...t,subjects:e.target.value}),placeholder:"Subjects you can handle"})]}),o("label",{htmlFor:"timeFrom",className:"-mb-4",children:"Select the time, when you become free"}),r(s,{children:[o(l,{pointerEvents:"none",children:o(y,{color:"gray.300"})}),o(p,{type:"time",value:t.timeFrom,onChange:e=>n({...t,timeFrom:e.target.value}),placeholder:"Time from you are free"})]}),o("label",{htmlFor:"timeTo",className:"-mb-4",children:"Select the time, when you are free upto"}),r(s,{children:[o(l,{pointerEvents:"none",children:o(y,{color:"gray.300"})}),o(p,{type:"time",value:t.timeTo,onChange:e=>n({...t,timeTo:e.target.value}),placeholder:"Time upto you are free"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(H,{color:"gray.300"})}),o(p,{type:"text",value:t.profession,onChange:e=>n({...t,profession:e.target.value}),placeholder:"Enter your profession"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(Z,{color:"gray.300"})}),o(p,{type:"text",value:t.place,onChange:e=>n({...t,place:e.target.value}),placeholder:"Enter your place"})]}),r(s,{children:[o(l,{pointerEvents:"none",children:o(G,{color:"gray.300"})}),o(p,{type:"file",name:"profilePic",accept:"image/*",placeholder:"Dp",onChange:e=>{n({...t,profilePic:e.target.files[0]})},className:"pt-1"})]}),o(R,{isloading:F,loadingText:"Updating",colorScheme:"teal",variant:"solid",onClick:I,children:"UPDATE PROFILE"})]}),o("div",{className:"mt-5",children:o(J,{})})]})};export{ie as default};
